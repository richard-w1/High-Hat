{% extends 'layout.html' %}

{% block title %}System Analysis{% endblock %}

{% block content %}
<div class="card">
  <h2><span class="material-icons" style="vertical-align: middle; margin-right: 0.5rem;">analytics</span>System Analysis & Metrics</h2>
  <p style="color: var(--muted-foreground);">Comprehensive analytics and performance metrics for the security monitoring system</p>
</div>

<!-- Analytics & Visualizations -->
<div class="card" style="margin-top: 2rem;">
  <h3><span class="material-icons" style="vertical-align: middle; margin-right: 0.5rem;">analytics</span>System Analytics</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; margin-top: 1.5rem;">
    
    <!-- Detection Timeline -->
    <div>
      <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--muted-foreground);">Detection Activity (Last 24h)</h4>
      <canvas id="detectionTimelineChart" style="max-height: 250px;"></canvas>
    </div>
    
    <!-- Incident Types Distribution -->
    <div>
      <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--muted-foreground);">Threat Detection Rate</h4>
      <canvas id="threatDistributionChart" style="max-height: 250px;"></canvas>
    </div>
    
  </div>
</div>

<!-- Performance Metrics -->
<div class="card" style="margin-top: 2rem;">
  <h3><span class="material-icons" style="vertical-align: middle; margin-right: 0.5rem;">speed</span>Performance Metrics</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; margin-top: 1.5rem;">
    
    <!-- Hand Detection Confidence -->
    <div>
      <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--muted-foreground);">Hand Detection Confidence Distribution</h4>
      <canvas id="confidenceDistributionChart" style="max-height: 250px;"></canvas>
    </div>
    
    <!-- Session Duration Trends -->
    <div>
      <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--muted-foreground);">Session Duration History</h4>
      <canvas id="sessionDurationChart" style="max-height: 250px;"></canvas>
    </div>
    
  </div>
</div>

<!-- Incident Analysis -->
<div class="card" style="margin-top: 2rem;">
  <h3><span class="material-icons" style="vertical-align: middle; margin-right: 0.5rem;">bar_chart</span>Incident Analysis</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; margin-top: 1.5rem;">
    
    <!-- Incidents per Session -->
    <div>
      <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--muted-foreground);">Incidents per Session</h4>
      <canvas id="incidentsPerSessionChart" style="max-height: 250px;"></canvas>
    </div>
    
    <!-- Escalation Rate -->
    <div>
      <h4 style="margin-bottom: 1rem; font-size: 1rem; color: var(--muted-foreground);">Escalation Rate Trend</h4>
      <canvas id="escalationRateChart" style="max-height: 250px;"></canvas>
    </div>
    
  </div>
</div>

<!-- Summary Statistics -->
<div class="card" style="margin-top: 2rem;">
  <h3><span class="material-icons" style="vertical-align: middle; margin-right: 0.5rem;">summarize</span>Summary Statistics</h3>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
    <div style="background: var(--muted); padding: 1.5rem; border-radius: var(--radius); text-align: center;">
      <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary);" id="totalSessions">0</div>
      <div style="font-size: 0.875rem; color: var(--muted-foreground); margin-top: 0.5rem;">Total Sessions</div>
    </div>
    <div style="background: var(--muted); padding: 1.5rem; border-radius: var(--radius); text-align: center;">
      <div style="font-size: 2.5rem; font-weight: 700; color: var(--warning);" id="totalIncidents">0</div>
      <div style="font-size: 0.875rem; color: var(--muted-foreground); margin-top: 0.5rem;">Total Incidents</div>
    </div>
    <div style="background: var(--muted); padding: 1.5rem; border-radius: var(--radius); text-align: center;">
      <div style="font-size: 2.5rem; font-weight: 700; color: var(--danger);" id="totalThreats">0</div>
      <div style="font-size: 0.875rem; color: var(--muted-foreground); margin-top: 0.5rem;">Threats Detected</div>
    </div>
    <div style="background: var(--muted); padding: 1.5rem; border-radius: var(--radius); text-align: center;">
      <div style="font-size: 2.5rem; font-weight: 700; color: var(--success);" id="avgDuration">0s</div>
      <div style="font-size: 0.875rem; color: var(--muted-foreground); margin-top: 0.5rem;">Avg Session Duration</div>
    </div>
    <div style="background: var(--muted); padding: 1.5rem; border-radius: var(--radius); text-align: center;">
      <div style="font-size: 2.5rem; font-weight: 700; color: var(--primary);" id="avgFrames">0</div>
      <div style="font-size: 0.875rem; color: var(--muted-foreground); margin-top: 0.5rem;">Avg Frames/Session</div>
    </div>
    <div style="background: var(--muted); padding: 1.5rem; border-radius: var(--radius); text-align: center;">
      <div style="font-size: 2.5rem; font-weight: 700; color: var(--warning);" id="detectionRate">0%</div>
      <div style="font-size: 0.875rem; color: var(--muted-foreground); margin-top: 0.5rem;">Threat Detection Rate</div>
    </div>
  </div>
</div>

<script src="{{ url_for('static', filename='analysis-charts.js') }}"></script>
{% endblock %}

